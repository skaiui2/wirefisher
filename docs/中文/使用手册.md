# wirefisher
Wirefisher：一个基于eBPF技术的网络观察及流量控制工具。

支持网卡、ip及端口、进程、进程组级别的流量观察，统计对应的流速及记录数据包信息，也支持对应的流量限速功能，可根据需求自定义针对进程或者端口进行限流。

后期会开发网络优化功能，如流量重定向、负载均衡器、零拷贝等。

## 使用方式

Wirefisher 的使用非常简单，只需编写YAML 配置文件，指定你要控制的对象和速率即可：

## 功能特点

- 按进程限速（PID）
- 按 IP、端口、协议过滤与限速
- 按网卡进行速率控制
- 按 cgroup 统一调度
- 支持 ingress / egress 双向控制
- 实时速率统计：平均速率、峰值速率、平滑速率

## 配置文件示例

进入配置目录：

先git:

```
git@github.com:skaiui2/wirefisher.git
```

然后进入配置目录：

```bash
cd config
vim config.yaml
```

可以这样配置：

```
process_module:
  process_rule:
    target_pid: 4580
    rate_bps: 1M
    gress: ingress
    time_scale: 1s
```



## 编译与运行

编译 BPF 程序：

```bash
cd bpf
make
cd ..
```

构建用户态控制程序：

```bash
mkdir build
cd build
cmake ..
make
```

启动 Wirefisher：

```bash
sudo ./ebpf_system
```

程序将根据 `config.yaml` 中的配置自动加载限速规则并开始运行。

## 环境要求

- Linux 内核版本 ≥ 5.4，需支持 eBPF 和 CO-RE
- 需要 root 权限运行
- 安装 libbpf 和 clang 工具链

